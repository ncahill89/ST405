---
title: "ST405/ST645 Bayesian Data Analysis"
subtitle: "Assignment 1 Solutions "
author: "Prof. Niamh Cahill"
format: 
  html:
    embed-resources: true
    self-contained-math: true
editor: visual
---

# Solution \[Total = 30 Marks\]

Suppose you are modeling the waiting times (in minutes) for patients in a hospital emergency room, where each waiting time is assumed to follow an **Exponential distribution** with rate parameter $\lambda$. That is, the density for a single observation $x_i$ is:

$$
f(x_i \mid \lambda) = \lambda e^{-\lambda x_i}, \quad x_i > 0, \ \lambda > 0.
$$

You wish to use Bayesian methods to estimate $\lambda$. As a prior, you use a $Gamma(a, b)$ distribution for $\lambda$.

#### 1. Likelihood Function \[5 Marks\]

The likelihood for $x_1, \dots, x_n$ is the product of individual densities:

$$
p(x \mid \lambda) = \prod_{i=1}^n f(x_i \mid \lambda) = \prod_{i=1}^n \lambda e^{-\lambda x_i} \propto \lambda^n e^{-\lambda \sum_{i=1}^n x_i}.
$$

------------------------------------------------------------------------

#### 2. Why Gamma is an Appropriate Prior \[2 Marks\]

-   The rate parameter $\lambda > 0$, and the Gamma distribution is defined on $(0, \infty)$.

------------------------------------------------------------------------

#### 3. Prior Parameters for Gamma \[8 Marks\]

Given:

$$
E[\lambda] = \frac{a}{b} = 2, \quad SD[\lambda] = \sqrt{\frac{a}{b^2}} = 0.5
$$

Step 1: Solve for $b$ in terms of $a$ using SD:

$$
b = \frac{\sqrt{a}}{0.5}
$$

Step 2: Solve using mean:

$$
\frac{a}{b} = 2 \implies \frac{a}{\sqrt{a}/0.5} = 2 \implies 0.5 \sqrt{a} = 2 \implies a = 16
$$

Then:

$$
b = \frac{\sqrt{16}}{0.5} = \frac{4}{0.5} = 8
$$

So, the prior is $\lambda \sim Gamma(16,8)$

#### 4. Posterior Distribution \[6 Marks\]

The posterior, using conjugacy, is:

$$
p(\lambda \mid x) \propto \lambda^{a-1} e^{-b\lambda} \cdot \lambda^n e^{-\lambda \sum x_i} = \lambda^{a+n-1} e^{-(b+\sum x_i)\lambda}
$$

Thus:

$$
\lambda \mid x \sim Gamma(a + n,\, b + \sum_{i=1}^n x_i)
$$

------------------------------------------------------------------------

#### 5. Posterior Mean with Observed Data \[5 Marks\]

Observed data: $y = 2, 3, 1.5, 2, 3.5$

-   $n = 5$\
-   $\sum y_i = 12$\
-   Prior: $a = 16, b = 8$

Posterior:

$$
\lambda \mid y \sim Gamma(16+5, 8+12) = Gamma(21, 20)
$$

Posterior mean:

$$
E[\lambda \mid y] = \frac{21}{20} = 1.05
$$

------------------------------------------------------------------------

#### 6. Comparison and Insights \[4 Marks\]

| Estimate                           | Value |
|------------------------------------|-------|
| Prior mean $E[\lambda]$            | 2     |
| Posterior mean $E[\lambda \mid y]$ | 1.05  |
| MLE $1/\bar{y}$                    | 0.42  |

**Insights:**

-   Posterior mean is a compromise between prior and data: slightly lower than prior because observed waiting times are longer than expected.

------------------------------------------------------------------------

### **Distribution Information**

You can use the following information about the Exponential and Gamma distributions to help you with the question:

```{r, echo=FALSE}
library(knitr)

# Create the data for the table
data <- data.frame(
  `Probability Distribution` = c("Exponential", "Gamma"),
  `PMF/PDF` = c(
    "$$f(x \\mid \\lambda) = \\lambda e^{-\\lambda x},\\ x \\ge 0$$",
    "$$f(x \\mid a,b) = \\frac{b^a}{\\Gamma(a)} x^{a-1} e^{-b x},\\ x \\ge 0$$"
  ),
  `E(X)` = c(
    "$$\\frac{1}{\\lambda}$$",
    "$$\\frac{a}{b}$$"
  ),
  `Var(X)` = c(
    "$$\\frac{1}{\\lambda^2}$$",
    "$$\\frac{a}{b^2}$$"
  )
)

# Render the table using knitr::kable
kable(data, col.names = c("Probability Distribution", "PMF/PDF", "E(X)", "Var(X)"), escape = FALSE)
```
