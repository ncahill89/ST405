---
title: "ST405/ST645 Bayesian Data Analysis"
subtitle: "Assignment 1: "
author: "Prof. Niamh Cahill"
format: 
  html:
    embed-resources: true
    self-contained-math: true
editor: visual
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE)
library(tidyverse)
```

## Instructions

Please submit your answers to this assignment by October 22nd, 4:00 PM. Ensure that all calculations are clearly shown, and include explanations where necessary. You may refer to the provided distribution information to help with your answers.

------------------------------------------------------------------------

Suppose you are modeling the waiting times (in hours) for patients in a hospital emergency room, where each waiting time is assumed to follow an **Exponential distribution** with rate parameter $\lambda$. 

You wish to use Bayesian methods to estimate $\lambda$. As a prior, you use a $Gamma(a, b)$ distribution for $\lambda$.

------------------------------------------------------------------------

### Questions

1.  Write down the likelihood function $p(x|\lambda)$ for the sample $x_1, \dots, x_n$ (up to proportionality).

2.  Why is the Gamma distribution an appropriate prior for the rate parameter ($\lambda$) in this model?

3.  Suppose your prior belief is that the expected rate at which patients are seen is 2 per hour , with prior standard deviation of 0.5 units. Find the values of $a$ and $b$ for the Gamma prior that encode this belief.

4.  Assuming that the Gamma distribution is a conjugate prior for the exponential likelihood, derive the posterior distribution for $\lambda$ given observations $x_1, \dots, x_n$.

5.  Suppose the observed data are $y = 2, 3, 1.5, 2, 3.5$. Find the posterior expected value of $\lambda$.


6.  Compare the posterior expected value of $\lambda$ to:

    -   The prior expected value of $\lambda$, and
    
    -   The maximum likelihood estimate (MLE) from the observed data ($1/\bar{y}$). What insights do you gain from this comparison in terms of how Bayesian updating works?

------------------------------------------------------------------------

### **Distribution Information**

You can use the following information about the Exponential and Gamma distributions to help you with the question:

```{r, echo=FALSE}
library(knitr)

# Create the data for the table
data <- data.frame(
  `Probability Distribution` = c("Exponential", "Gamma"),
  `PMF/PDF` = c(
    "$$f(x \\mid \\lambda) = \\lambda e^{-\\lambda x},\\ x \\ge 0$$",
    "$$f(x \\mid a,b) = \\frac{b^a}{\\Gamma(a)} x^{a-1} e^{-b x},\\ x \\ge 0$$"
  ),
  `E(X)` = c(
    "$$\\frac{1}{\\lambda}$$",
    "$$\\frac{a}{b}$$"
  ),
  `Var(X)` = c(
    "$$\\frac{1}{\\lambda^2}$$",
    "$$\\frac{a}{b^2}$$"
  )
)

# Render the table using knitr::kable
kable(data, col.names = c("Probability Distribution", "PMF/PDF", "E(X)", "Var(X)"), escape = FALSE)
```

