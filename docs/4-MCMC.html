<!DOCTYPE html>
<html lang="en"><head>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-html/tabby.min.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/light-border.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-html.min.css" rel="stylesheet" data-mode="light">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles"><meta charset="utf-8">
  <meta name="generator" content="quarto-1.5.57">

  <meta name="author" content="Prof.&nbsp;Niamh Cahill (she/her)">
  <title>Bayesian Data Analysis</title>
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, minimal-ui">
  <link rel="stylesheet" href="site_libs/revealjs/dist/reset.css">
  <link rel="stylesheet" href="site_libs/revealjs/dist/reveal.css">
  <style>
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    div.columns{display: flex; gap: min(4vw, 1.5em);}
    div.column{flex: auto; overflow-x: auto;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
    ul.task-list li input[type="checkbox"] {
      width: 0.8em;
      margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
      vertical-align: middle;
    }
    /* CSS for syntax highlighting */
    pre > code.sourceCode { white-space: pre; position: relative; }
    pre > code.sourceCode > span { line-height: 1.25; }
    pre > code.sourceCode > span:empty { height: 1.2em; }
    .sourceCode { overflow: visible; }
    code.sourceCode > span { color: inherit; text-decoration: inherit; }
    div.sourceCode { margin: 1em 0; }
    pre.sourceCode { margin: 0; }
    @media screen {
    div.sourceCode { overflow: auto; }
    }
    @media print {
    pre > code.sourceCode { white-space: pre-wrap; }
    pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
    }
    pre.numberSource code
      { counter-reset: source-line 0; }
    pre.numberSource code > span
      { position: relative; left: -4em; counter-increment: source-line; }
    pre.numberSource code > span > a:first-child::before
      { content: counter(source-line);
        position: relative; left: -1em; text-align: right; vertical-align: baseline;
        border: none; display: inline-block;
        -webkit-touch-callout: none; -webkit-user-select: none;
        -khtml-user-select: none; -moz-user-select: none;
        -ms-user-select: none; user-select: none;
        padding: 0 4px; width: 4em;
        color: #aaaaaa;
      }
    pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
    div.sourceCode
      { color: #003b4f; background-color: #f1f3f5; }
    @media screen {
    pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
    }
    code span { color: #003b4f; } /* Normal */
    code span.al { color: #ad0000; } /* Alert */
    code span.an { color: #5e5e5e; } /* Annotation */
    code span.at { color: #657422; } /* Attribute */
    code span.bn { color: #ad0000; } /* BaseN */
    code span.bu { } /* BuiltIn */
    code span.cf { color: #003b4f; font-weight: bold; } /* ControlFlow */
    code span.ch { color: #20794d; } /* Char */
    code span.cn { color: #8f5902; } /* Constant */
    code span.co { color: #5e5e5e; } /* Comment */
    code span.cv { color: #5e5e5e; font-style: italic; } /* CommentVar */
    code span.do { color: #5e5e5e; font-style: italic; } /* Documentation */
    code span.dt { color: #ad0000; } /* DataType */
    code span.dv { color: #ad0000; } /* DecVal */
    code span.er { color: #ad0000; } /* Error */
    code span.ex { } /* Extension */
    code span.fl { color: #ad0000; } /* Float */
    code span.fu { color: #4758ab; } /* Function */
    code span.im { color: #00769e; } /* Import */
    code span.in { color: #5e5e5e; } /* Information */
    code span.kw { color: #003b4f; font-weight: bold; } /* Keyword */
    code span.op { color: #5e5e5e; } /* Operator */
    code span.ot { color: #003b4f; } /* Other */
    code span.pp { color: #ad0000; } /* Preprocessor */
    code span.sc { color: #5e5e5e; } /* SpecialChar */
    code span.ss { color: #20794d; } /* SpecialString */
    code span.st { color: #20794d; } /* String */
    code span.va { color: #111111; } /* Variable */
    code span.vs { color: #20794d; } /* VerbatimString */
    code span.wa { color: #5e5e5e; font-style: italic; } /* Warning */
  </style>
  <link rel="stylesheet" href="site_libs/revealjs/dist/theme/quarto.css">
  <link href="site_libs/revealjs/plugin/quarto-line-highlight/line-highlight.css" rel="stylesheet">
  <link href="site_libs/revealjs/plugin/reveal-menu/menu.css" rel="stylesheet">
  <link href="site_libs/revealjs/plugin/reveal-menu/quarto-menu.css" rel="stylesheet">
  <link href="site_libs/revealjs/plugin/quarto-support/footer.css" rel="stylesheet">
  <style type="text/css">

  .callout {
    margin-top: 1em;
    margin-bottom: 1em;  
    border-radius: .25rem;
  }

  .callout.callout-style-simple { 
    padding: 0em 0.5em;
    border-left: solid #acacac .3rem;
    border-right: solid 1px silver;
    border-top: solid 1px silver;
    border-bottom: solid 1px silver;
    display: flex;
  }

  .callout.callout-style-default {
    border-left: solid #acacac .3rem;
    border-right: solid 1px silver;
    border-top: solid 1px silver;
    border-bottom: solid 1px silver;
  }

  .callout .callout-body-container {
    flex-grow: 1;
  }

  .callout.callout-style-simple .callout-body {
    font-size: 1rem;
    font-weight: 400;
  }

  .callout.callout-style-default .callout-body {
    font-size: 0.9rem;
    font-weight: 400;
  }

  .callout.callout-titled.callout-style-simple .callout-body {
    margin-top: 0.2em;
  }

  .callout:not(.callout-titled) .callout-body {
      display: flex;
  }

  .callout:not(.no-icon).callout-titled.callout-style-simple .callout-content {
    padding-left: 1.6em;
  }

  .callout.callout-titled .callout-header {
    padding-top: 0.2em;
    margin-bottom: -0.2em;
  }

  .callout.callout-titled .callout-title  p {
    margin-top: 0.5em;
    margin-bottom: 0.5em;
  }
    
  .callout.callout-titled.callout-style-simple .callout-content  p {
    margin-top: 0;
  }

  .callout.callout-titled.callout-style-default .callout-content  p {
    margin-top: 0.7em;
  }

  .callout.callout-style-simple div.callout-title {
    border-bottom: none;
    font-size: .9rem;
    font-weight: 600;
    opacity: 75%;
  }

  .callout.callout-style-default  div.callout-title {
    border-bottom: none;
    font-weight: 600;
    opacity: 85%;
    font-size: 0.9rem;
    padding-left: 0.5em;
    padding-right: 0.5em;
  }

  .callout.callout-style-default div.callout-content {
    padding-left: 0.5em;
    padding-right: 0.5em;
  }

  .callout.callout-style-simple .callout-icon::before {
    height: 1rem;
    width: 1rem;
    display: inline-block;
    content: "";
    background-repeat: no-repeat;
    background-size: 1rem 1rem;
  }

  .callout.callout-style-default .callout-icon::before {
    height: 0.9rem;
    width: 0.9rem;
    display: inline-block;
    content: "";
    background-repeat: no-repeat;
    background-size: 0.9rem 0.9rem;
  }

  .callout-title {
    display: flex
  }
    
  .callout-icon::before {
    margin-top: 1rem;
    padding-right: .5rem;
  }

  .callout.no-icon::before {
    display: none !important;
  }

  .callout.callout-titled .callout-body > .callout-content > :last-child {
    padding-bottom: 0.5rem;
    margin-bottom: 0;
  }

  .callout.callout-titled .callout-icon::before {
    margin-top: .5rem;
    padding-right: .5rem;
  }

  .callout:not(.callout-titled) .callout-icon::before {
    margin-top: 1rem;
    padding-right: .5rem;
  }

  /* Callout Types */

  div.callout-note {
    border-left-color: #4582ec !important;
  }

  div.callout-note .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAEU0lEQVRYCcVXTWhcVRQ+586kSUMMxkyaElstCto2SIhitS5Ek8xUKV2poatCcVHtUlFQk8mbaaziwpWgglJwVaquitBOfhQXFlqlzSJpFSpIYyXNjBNiTCck7x2/8/LeNDOZxDuEkgOXe++553zfefee+/OYLOXFk3+1LLrRdiO81yNqZ6K9cG0P3MeFaMIQjXssE8Z1JzLO9ls20MBZX7oG8w9GxB0goaPrW5aNMp1yOZIa7Wv6o2ykpLtmAPs/vrG14Z+6d4jpbSKuhdcSyq9wGMPXjonwmESXrriLzFGOdDBLB8Y6MNYBu0dRokSygMA/mrun8MGFN3behm6VVAwg4WR3i6FvYK1T7MHo9BK7ydH+1uurECoouk5MPRyVSBrBHMYwVobG2aOXM07sWrn5qgB60rc6mcwIDJtQrnrEr44kmy+UO9r0u9O5/YbkS9juQckLed3DyW2XV/qWBBB3ptvI8EUY3I9p/67OW+g967TNr3Sotn3IuVlfMLVnsBwH4fsnebJvyGm5GeIUA3jljERmrv49SizPYuq+z7c2H/jlGC+Ghhupn/hcapqmcudB9jwJ/3jvnvu6vu5lVzF1fXyZuZZ7U8nRmVzytvT+H3kilYvH09mLWrQdwFSsFEsxFVs5fK7A0g8gMZjbif4ACpKbjv7gNGaD8bUrlk8x+KRflttr22JEMRUbTUwwDQScyzPgedQHZT0xnx7ujw2jfVfExwYHwOsDTjLdJ2ebmeQIlJ7neo41s/DrsL3kl+W2lWvAga0tR3zueGr6GL78M3ifH0rGXrBC2aAR8uYcIA5gwV8zIE8onoh8u0Fca/ciF7j1uOzEnqcIm59sEXoGc0+z6+H45V1CvAvHcD7THztu669cnp+L0okAeIc6zjbM/24LgGM1gZk7jnRu1aQWoU9sfUOuhrmtaPIO3YY1KLLWZaEO5TKUbMY5zx8W9UJ6elpLwKXbsaZ4EFl7B4bMtDv0iRipKoDQT2sNQI9b1utXFdYisi+wzZ/ri/1m7QfDgEuvgUUEIJPq3DhX/5DWNqIXDOweC2wvIR90Oq3lDpdMIgD2r0dXvGdsEW5H6x6HLRJYU7C69VefO1x8Gde1ZFSJLfWS1jbCnhtOPxmpfv2LXOA2Xk2tvnwKKPFuZ/oRmwBwqRQDcKNeVQkYcOjtWVBuM/JuYw5b6isojIkYxyYAFn5K7ZBF10fea52y8QltAg6jnMqNHFBmGkQ1j+U43HMi2xMar1Nv0zGsf1s8nUsmUtPOOrbFIR8bHFDMB5zL13Gmr/kGlCkUzedTzzmzsaJXhYawnA3UmARpiYj5ooJZiUoxFRtK3X6pgNPv+IZVPcnwbOl6f+aBaO1CNvPW9n9LmCp01nuSaTRF2YxHqZ8DYQT6WsXT+RD6eUztwYLZ8rM+rcPxamv1VQzFUkzFXvkiVrySGQgJNvXHJAxiU3/NwiC03rSf05VBaPtu/Z7/B8Yn/w7eguloAAAAAElFTkSuQmCC');
  }

  div.callout-note.callout-style-default .callout-title {
    background-color: #dae6fb
  }

  div.callout-important {
    border-left-color: #d9534f !important;
  }

  div.callout-important .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAEKklEQVRYCcVXTWhcVRS+575MJym48A+hSRFr00ySRQhURRfd2HYjk2SSTokuBCkU2o0LoSKKraKIBTcuFCoidGFD08nkBzdREbpQ1EDNIv8qSGMFUboImMSZd4/f9zJv8ibJMC8xJQfO3HPPPef7zrvvvnvviIkpC9nsw0UttFunbUhpFzFtarSd6WJkStVMw5xyVqYTvkwfzuf/5FgtkVoB0729j1rjXwThS7Vio+Mo6DNnvLfahoZ+i/o32lULuJ3NNiz7q6+pyAUkJaFF6JwaM2lUJlV0MlnQn5aTRbEu0SEqHUa0A4AdiGuB1kFXRfVyg5d87+Dg4DL6m2TLAub60ilj7A1Ec4odSAc8X95sHh7+ZRPCFo6Fnp7HfU/fBng/hi10CjCnWnJjsxvDNxWw0NfV6Rv5GgP3I3jGWXumdTD/3cbEOP2ZbOZp69yniG3FQ9z1jD7bnBu9Fc2tKGC2q+uAJOQHBDRiZX1x36o7fWBs7J9ownbtO+n0/qWkvW7UPIfc37WgT6ZGR++EOJyeQDSb9UB+DZ1G6DdLDzyS+b/kBCYGsYgJbSQHuThGKRcw5xdeQf8YdNHsc6ePXrlSYMBuSIAFTGAtQo+VuALo4BX83N190NWZWbynBjhOHsmNfFWLeL6v+ynsA58zDvvAC8j5PkbOcXCMg2PZFk3q8MjI7WAG/Dp9AwP7jdGBOOQkAvlFUB+irtm16I1Zw9YBcpGTGXYmk3kQIC/Cds55l+iMI3jqhjAuaoe+am2Jw5GT3Nbz3CkE12NavmzN5+erJW7046n/CH1RO/RVa8lBLozXk9uqykkGAyRXLWlLv5jyp4RFsG5vGVzpDLnIjTWgnRy2Rr+tDKvRc7Y8AyZq10jj8DqXdnIRNtFZb+t/ZRtXcDiVnzpqx8mPcDWxgARUqx0W1QB9MeUZiNrV4qP+Ehc+BpNgATsTX8ozYKL2NtFYAHc84fG7ndxUPr+AR/iQSns7uSUufAymwDOb2+NjK27lEFocm/EE2WpyIy/Hi66MWuMKJn8RvxIcj87IM5Vh9663ziW36kR0HNenXuxmfaD8JC7tfKbrhFr7LiZCrMjrzTeGx+PmkosrkNzW94ObzwocJ7A1HokLolY+AvkTiD/q1H0cN48c5EL8Crkttsa/AXQVDmutfyku0E7jShx49XqV3MFK8IryDhYVbj7Sj2P2eBxwcXoe8T8idsKKPRcnZw1b+slFTubwUwhktrfnAt7J++jwQtLZcm3sr9LQrjRzz6cfMv9aLvgmnAGvpoaGLxM4mAEaLV7iAzQ3oU0IvD5x9ix3yF2RAAuYAOO2f7PEFWCXZ4C9Pb2UsgDeVnFSpbFK7/IWu7TPTvBqzbGdCHOJQSxiEjt6IyZmxQyEJHv6xyQsYk//moVFsN2zP6fRImjfq7/n/wFDguUQFNEwugAAAABJRU5ErkJggg==');
  }

  div.callout-important.callout-style-default .callout-title {
    background-color: #f7dddc
  }

  div.callout-warning {
    border-left-color: #f0ad4e !important;
  }

  div.callout-warning .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAETklEQVRYCeVWW2gcVRg+58yaTUnizqbipZeX4uWhBEniBaoUX1Ioze52t7sRq6APio9V9MEaoWlVsFasRq0gltaAPuxms8lu0gcviE/FFOstVbSIxgcv6SU7EZqmdc7v9+9mJtNks51NTUH84ed889/PP+cmxP+d5FIbMJmNbpREu4WUkiTtCicKny0l1pIKmBzovF2S+hIJHX8iEu3hZJ5lNZGqyRrGSIQpq15AzF28jgpeY6yk6GVdrfFqdrD6Iw+QlB8g0YS2g7dyQmXM/IDhBhT0UCiRf59lfqmmDvzRt6kByV/m4JjtzuaujMUM2c5Z2d6JdKrRb3K2q6mA+oYVz8JnDdKPmmNthzkAk/lN63sYPgevrguc72aZX/L9C6x09GYyxBgCX4NlvyGUHOKELlm5rXeR1kchuChJt4SSwyddZRXgvwMGvYo4QSlk3/zkHD8UHxwVJA6zjZZqP8v8kK8OWLnIZtLyCAJagYC4rTGW/9Pqj92N/c+LUaAj27movwbi19tk/whRCIE7Q9vyI6yvRpftAKVTdUjOW40X3h5OXsKCdmFcx0xlLJoSuQngnrJe7Kcjm4OMq9FlC7CMmScQANuNvjfP3PjGXDBaUQmbp296S5L4DrpbrHN1T87ZVEZVCzg1FF0Ft+dKrlLukI+/c9ENo+TvlTDbYFvuKPtQ9+l052rXrgKoWkDAFnvh0wTOmYn8R5f4k/jN/fZiCM1tQx9jQQ4ANhqG4hiL0qIFTGViG9DKB7GYzgubnpofgYRwO+DFjh0Zin2m4b/97EDkXkc+f6xYAPX0KK2I/7fUQuwzuwo/L3AkcjugPNixC8cHf0FyPjWlItmLxWw4Ou9YsQCr5fijMGoD/zpdRy95HRysyXA74MWOnscpO4j2y3HAVisw85hX5+AFBRSHt4ShfLFkIMXTqyKFc46xdzQM6XbAi702a7sy04J0+feReMFKp5q9esYLCqAZYw/k14E/xcLLsFElaornTuJB0svMuJINy8xkIYuL+xPAlWRceH6+HX7THJ0djLUom46zREu7tTkxwmf/FdOZ/sh6Q8qvEAiHpm4PJ4a/doJe0gH1t+aHRgCzOvBvJedEK5OFE5jpm4AGP2a8Dxe3gGJ/pAutug9Gp6he92CsSsWBaEcxGx0FHytmIpuqGkOpldqNYQK8cSoXvd+xLxXADw0kf6UkJNFtdo5MOgaLjiQOQHcn+A6h5NuL2s0qsC2LOM75PcF3yr5STuBSAcGG+meA14K/CI21HcS4LBT6tv0QAh8Dr5l93AhZzG5ZJ4VxAqdZUEl9z7WJ4aN+svMvwHHL21UKTd1mqvChH7/Za5xzXBBKrUcB0TQ+Ulgkfbi/H/YT5EptrGzsEK7tR1B7ln9BBwckYfMiuSqklSznIuoIIOM42MQO+QnduCoFCI0bpkzjCjddHPN/F+2Yu+sd9bKNpVwHhbS3LluK/0zgfwD0xYI5dXuzlQAAAABJRU5ErkJggg==');
  }

  div.callout-warning.callout-style-default .callout-title {
    background-color: #fcefdc
  }

  div.callout-tip {
    border-left-color: #02b875 !important;
  }

  div.callout-tip .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAADr0lEQVRYCe1XTWgTQRj9ZjZV8a9SPIkKgj8I1bMHsUWrqYLVg4Ue6v9BwZOxSYsIerFao7UiUryIqJcqgtpimhbBXoSCVxUFe9CTiogUrUp2Pt+3aUI2u5vdNh4dmMzOzHvvezuz8xNFM0mjnbXaNu1MvFWRXkXEyE6aYOYJpdW4IXuA4r0fo8qqSMDBU0v1HJUgVieAXxzCsdE/YJTdFcVIZQNMyhruOMJKXYFoLfIfIvVIMWdsrd+Rpd86ZmyzzjJmLStqRn0v8lzkb4rVIXvnpScOJuAn2ACC65FkPzEdEy4TPWRLJ2h7z4cArXzzaOdKlbOvKKX25Wl00jSnrwVxAg3o4dRxhO13RBSdNvH0xSARv3adTXbBdTf64IWO2vH0LT+cv4GR1DJt+DUItaQogeBX/chhbTBxEiZ6gftlDNXTrvT7co4ub5A6gp9HIcHvzTa46OS5fBeP87Qm0fQkr4FsYgVQ7Qg+ZayaDg9jhg1GkWj8RG6lkeSacrrHgDaxdoBiZPg+NXV/KifMuB6//JmYH4CntVEHy/keA6x4h4CU5oFy8GzrBS18cLJMXcljAKB6INjWsRcuZBWVaS3GDrqB7rdapVIeA+isQ57Eev9eCqzqOa81CY05VLd6SamW2wA2H3SiTbnbSxmzfp7WtKZkqy4mdyAlGx7ennghYf8voqp9cLSgKdqNfa6RdRsAAkPwRuJZNbpByn+RrJi1RXTwdi8RQF6ymDwGMAtZ6TVE+4uoKh+MYkcLsT0Hk8eAienbiGdjJHZTpmNjlbFJNKDVAp2fJlYju6IreQxQ08UJDNYdoLSl6AadO+fFuCQqVMB1NJwPm69T04Wv5WhfcWyfXQB+wXRs1pt+nCknRa0LVzSA/2B+a9+zQJadb7IyyV24YAxKp2Jqs3emZTuNnKxsah+uabKbMk7CbTgJx/zIgQYErIeTKRQ9yD9wxVof5YolPHqaWo7TD6tJlh7jQnK5z2n3+fGdggIOx2kaa2YI9QWarc5Ce1ipNWMKeSG4DysFF52KBmTNMmn5HqCFkwy34rDg05gDwgH3bBi+sgFhN/e8QvRn8kbamCOhgrZ9GJhFDgfcMHzFb6BAtjKpFhzTjwv1KCVuxHvCbsSiEz4CANnj84cwHdFXAbAOJ4LTSAawGWFn5tDhLMYz6nWeU2wJfIhmIJBefcd/A5FWQWGgrWzyORZ3Q6HuV+Jf0Bj+BTX69fm1zWgK7By1YTXchFDORywnfQ7GpzOo6S+qECrsx2ifVQAAAABJRU5ErkJggg==');
  }

  div.callout-tip.callout-style-default .callout-title {
    background-color: #ccf1e3
  }

  div.callout-caution {
    border-left-color: #fd7e14 !important;
  }

  div.callout-caution .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAACV0lEQVRYCdVWzWoUQRCuqp2ICBLJXgITZL1EfQDBW/bkzUMUD7klD+ATSHBEfAIfQO+iXsWDxJsHL96EHAwhgzlkg8nBg25XWb0zIb0zs9muYYWkoKeru+vn664fBqElyZNuyh167NXJ8Ut8McjbmEraKHkd7uAnAFku+VWdb3reSmRV8PKSLfZ0Gjn3a6Xlcq9YGb6tADjn+lUfTXtVmaZ1KwBIvFI11rRXlWlatwIAAv2asaa9mlB9wwygiDX26qaw1yYPzFXg2N1GgG0FMF8Oj+VIx7E/03lHx8UhvYyNZLN7BwSPgekXXLribw7w5/c8EF+DBK5idvDVYtEEwMeYefjjLAdEyQ3M9nfOkgnPTEkYU+sxMq0BxNR6jExrAI31H1rzvLEfRIdgcv1XEdj6QTQAS2wtstEALLG1yEZ3QhH6oDX7ExBSFEkFINXH98NTrme5IOaaA7kIfiu2L8A3qhH9zRbukdCqdsA98TdElyeMe5BI8Rs2xHRIsoTSSVFfCFCWGPn9XHb4cdobRIWABNf0add9jakDjQJpJ1bTXOJXnnRXHRf+dNL1ZV1MBRCXhMbaHqGI1JkKIL7+i8uffuP6wVQAzO7+qVEbF6NbS0LJureYcWXUUhH66nLR5rYmva+2tjRFtojkM2aD76HEGAD3tPtKM309FJg5j/K682ywcWJ3PASCcycH/22u+Bh7Aa0ehM2Fu4z0SAE81HF9RkB21c5bEn4Dzw+/qNOyXr3DCTQDMBOdhi4nAgiFDGCinIa2owCEChUwD8qzd03PG+qdW/4fDzjUMcE1ZpIAAAAASUVORK5CYII=');
  }

  div.callout-caution.callout-style-default .callout-title {
    background-color: #ffe5d0
  }

  </style>
  <style type="text/css">
    .reveal div.sourceCode {
      margin: 0;
      overflow: auto;
    }
    .reveal div.hanging-indent {
      margin-left: 1em;
      text-indent: -1em;
    }
    .reveal .slide:not(.center) {
      height: 100%;
    }
    .reveal .slide.scrollable {
      overflow-y: auto;
    }
    .reveal .footnotes {
      height: 100%;
      overflow-y: auto;
    }
    .reveal .slide .absolute {
      position: absolute;
      display: block;
    }
    .reveal .footnotes ol {
      counter-reset: ol;
      list-style-type: none; 
      margin-left: 0;
    }
    .reveal .footnotes ol li:before {
      counter-increment: ol;
      content: counter(ol) ". "; 
    }
    .reveal .footnotes ol li > p:first-child {
      display: inline-block;
    }
    .reveal .slide ul,
    .reveal .slide ol {
      margin-bottom: 0.5em;
    }
    .reveal .slide ul li,
    .reveal .slide ol li {
      margin-top: 0.4em;
      margin-bottom: 0.2em;
    }
    .reveal .slide ul[role="tablist"] li {
      margin-bottom: 0;
    }
    .reveal .slide ul li > *:first-child,
    .reveal .slide ol li > *:first-child {
      margin-block-start: 0;
    }
    .reveal .slide ul li > *:last-child,
    .reveal .slide ol li > *:last-child {
      margin-block-end: 0;
    }
    .reveal .slide .columns:nth-child(3) {
      margin-block-start: 0.8em;
    }
    .reveal blockquote {
      box-shadow: none;
    }
    .reveal .tippy-content>* {
      margin-top: 0.2em;
      margin-bottom: 0.7em;
    }
    .reveal .tippy-content>*:last-child {
      margin-bottom: 0.2em;
    }
    .reveal .slide > img.stretch.quarto-figure-center,
    .reveal .slide > img.r-stretch.quarto-figure-center {
      display: block;
      margin-left: auto;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-left,
    .reveal .slide > img.r-stretch.quarto-figure-left  {
      display: block;
      margin-left: 0;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-right,
    .reveal .slide > img.r-stretch.quarto-figure-right  {
      display: block;
      margin-left: auto;
      margin-right: 0; 
    }
  </style>
</head>
<body class="quarto-light">
  <div class="reveal">
    <div class="slides">

<section id="title-slide" class="quarto-title-block center">
  <h1 class="title">Bayesian Data Analysis</h1>
  <p class="subtitle">MCMC</p>

<div class="quarto-title-authors">
<div class="quarto-title-author">
<div class="quarto-title-author-name">
Prof.&nbsp;Niamh Cahill (she/her) 
</div>
</div>
</div>

</section>
<section id="what-do-we-know-so-far" class="slide level2" style="font-size: 70%;">
<h2>What do we know so far?</h2>
<p>We can use Bayes‚Äô rule to get posterior densities</p>
<ul>
<li><p>Example for single parameter Normal - <span class="math inline">\(\mu\)</span></p>
<ul>
<li><span class="math inline">\(p(\mu|y) \propto p(y|\mu)p(\mu)\)</span></li>
</ul></li>
<li><p>Example for single parameter Normal - <span class="math inline">\(\tau\)</span></p>
<ul>
<li><span class="math inline">\(p(\tau|y) \propto p(y|\tau)p(\tau)\)</span></li>
</ul></li>
<li><p>We could also do this for multiple parameters</p>
<ul>
<li><span class="math inline">\(p(\mu, \tau|y) \propto p(y|\mu,\tau)p(\mu,\tau)\)</span></li>
</ul></li>
</ul>
<p>BUT‚Ä¶</p>
<ul>
<li><p>Realistic problems with multiple parameters, data points, and common choices of priors don‚Äôt get a closed-form expression for <span class="math inline">\(p(\mu, \tau|y)\)</span></p></li>
<li><p>Sampling to the rescue!!</p></li>
</ul>
</section>
<section id="simulation-based-inference-recap" class="slide level2" style="font-size: 70%;">
<h2>Simulation-based inference (recap)</h2>
<ul>
<li><p>The general idea in simulation-based inference: We can make inference about a parameter <span class="math inline">\(\theta\)</span> or <span class="math inline">\(\mu\)</span> or <span class="math inline">\(\tau\)</span> , using a sample e.g., <span class="math inline">\(\{\theta^{(1)}\ldots\theta^{(S)}\}\)</span>, from its probability distribution.</p></li>
<li><p>Assessing the properties of a target (e.g., posterior) distribution by generating representative samples is called Monte Carlo simulation.</p></li>
<li><p>Based on the law of large numbers we know that:</p>
<p><span class="math inline">\(\frac{1}{S}\sum_{s=1}^{S}\theta^{(s)} = E(\theta)\)</span></p>
<p>as sample size <span class="math inline">\(S \to \infty\)</span></p>
<ul>
<li>The error in the MC approximation goes to zero as <span class="math inline">\(S \to \infty\)</span> because <span class="math inline">\(\frac{var(\theta)}{S} \to 0\)</span></li>
</ul></li>
<li><p>Just about any aspect of the distribution of <span class="math inline">\(\theta\)</span> can be approximated arbitrarily exactly with a large enough Monte Carlo sample, e.g.,</p>
<ul>
<li>the <span class="math inline">\(\alpha\)</span>-percentile of the distribution of <span class="math inline">\(\theta\)</span></li>
<li><span class="math inline">\(Pr(\theta \geq x)\)</span> for any constant <span class="math inline">\(x\)</span></li>
</ul></li>
</ul>
</section>
<section id="markov-chain-monte-carlo-mcmc" class="slide level2" style="font-size: 70%;">
<h2>Markov Chain Monte Carlo (MCMC)</h2>
<p>We‚Äôve already discussed Monte Carlo sampling. Now we‚Äôre going to consider Markov Chain Monte Carlo (MCMC) sampling. MCMC algorithms are used for sampling from a target distribution.</p>
<div class="callout callout-note callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong>Markov Chain</strong></p>
</div>
<div class="callout-content">
<ul>
<li><p>Any process in which each step has no memory of states before the current state is called a (first-order) Markov process and a sucession of such steps is a Markov chain.</p></li>
<li><p>The stationary distribution of the Markov chain is the target distribution.</p></li>
</ul>
</div>
</div>
</div>
<p>Using MCMC we can construct a set of samples from an unknown target (e.g., posterior) distribution.</p>
</section>
<section id="a-simple-markov-chain-example" class="slide level2" style="font-size: 70%;">
<h2>A simple Markov chain example</h2>
<p>What is the probability of sunny <span class="math inline">\(P(S)\)</span> and rainy <span class="math inline">\(P(R)\)</span> weather?</p>
<div class="columns">
<div class="column" style="width:50%;">
<p><img data-src="images/rainy-sunny-weather-clouds-sun-rainbow-92959121.jpg.webp"></p>
</div><div class="column" style="width:50%;">
<p>Assume we have the following ‚Äútransition‚Äù probabilities:</p>
<p><span class="math inline">\(P(S_{t+1}|R_t) = 0.5\)</span></p>
<p><span class="math inline">\(P(R_{t+1}|R_t) = 0.5\)</span></p>
<p><span class="math inline">\(P(R_{t+1}|S_t) = 0.1\)</span></p>
<p><span class="math inline">\(P(S_{t+1}|S_t) = 0.9\)</span></p>
<p>Note the future state of the weather only depends on the current state.</p>
</div></div>
</section>
<section id="stationary-distributions" class="slide level2" style="font-size: 70%;">
<h2>Stationary Distributions</h2>
<p>As we progress through time, the probability of being in certain states (e.g., rainy or sunny) are more likely than others. Over the long run, the distribution will reach an equilibrium with an associated probability of being in each state.</p>
<p>This is known as the <strong>Stationary Distribution</strong>.</p>
<div class="callout callout-note callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong>The <strong>stationary distribution</strong> of a Markov chain</strong></p>
</div>
<div class="callout-content">
<p>The <strong>stationary distribution</strong> of a Markov chain is a probability distribution over the states of the chain that remains unchanged as time progresses.</p>
<p>Mathematically, if <span class="math inline">\(\pi\)</span> represents the stationary distribution (a row vector of probabilities) and <span class="math inline">\(P\)</span> is the transition matrix of the Markov chain, the stationary distribution satisfies the equation:</p>
<p><span class="math display">\[\pi = \pi P\]</span></p>
<p>This means that when the transition matrix <span class="math inline">\(P\)</span> is applied to <span class="math inline">\(\pi\)</span>, the result is still <span class="math inline">\(\pi\)</span>, indicating that the distribution has stabilized and doesn‚Äôt change over time.</p>
</div>
</div>
</div>
</section>
<section id="creating-the-markov-chain" class="slide level2" style="font-size: 65%;">
<h2>Creating the Markov Chain</h2>
<div class="columns">
<div class="column" style="width:50%;">
<h3 id="the-algorithm">The ‚Äúalgorithm‚Äù</h3>
<ol type="1">
<li><p>We have to initialize i.e., a randomly chosen start point of sunny or rainy.</p></li>
<li><p>We can sample the weather, W, (coded as 1 for sunny and 0 for rainy) from a Bernoulli distribution (Binomial with <span class="math inline">\(n=1\)</span>).</p></li>
</ol>
<ul>
<li>The probability distribution will change depending on the current state of the chain, i.e., if W = 1, or W =0.</li>
</ul>
<ol start="3" type="1">
<li>Based on the samples of <span class="math inline">\(W\)</span> we can estimate <span class="math inline">\(P(W=1) = P(S)\)</span> and <span class="math inline">\(P(W=0) = P(R)\)</span>.</li>
</ol>
<p>We find after enough iterations (samples) <span class="math inline">\(P(S) = 0.83\)</span>.</p>
</div><div class="column" style="width:50%;">
<h3 id="r-code">R code</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb1" data-code-line-numbers="1-4|5-19|20-22|12,13,23,25"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a></a><span class="co"># 0 = rainy, 1 = sunny</span></span>
<span id="cb1-2"><a></a></span>
<span id="cb1-3"><a></a><span class="co"># 1. initialize</span></span>
<span id="cb1-4"><a></a>W_current <span class="ot">&lt;-</span> <span class="fu">rbinom</span>(<span class="dv">1</span>,<span class="dv">1</span>,<span class="fl">0.5</span>) </span>
<span id="cb1-5"><a></a></span>
<span id="cb1-6"><a></a><span class="co"># 2. run the Markov Chain</span></span>
<span id="cb1-7"><a></a><span class="co"># number of Monte Carlo sampling interations</span></span>
<span id="cb1-8"><a></a>n_iter <span class="ot">&lt;-</span> <span class="dv">10000</span></span>
<span id="cb1-9"><a></a><span class="co"># save the samples</span></span>
<span id="cb1-10"><a></a>W_new <span class="ot">&lt;-</span> p_sunny <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="cn">NA</span>, n_iter)</span>
<span id="cb1-11"><a></a></span>
<span id="cb1-12"><a></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n_iter)</span>
<span id="cb1-13"><a></a>{</span>
<span id="cb1-14"><a></a>W_new[i] <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(W_current <span class="sc">==</span> <span class="dv">0</span>,</span>
<span id="cb1-15"><a></a>       <span class="fu">rbinom</span>(<span class="dv">1</span>,<span class="dv">1</span>,<span class="fl">0.5</span>),</span>
<span id="cb1-16"><a></a>       <span class="fu">rbinom</span>(<span class="dv">1</span>,<span class="dv">1</span>,<span class="fl">0.9</span>))</span>
<span id="cb1-17"><a></a></span>
<span id="cb1-18"><a></a>W_current <span class="ot">=</span> W_new[i]</span>
<span id="cb1-19"><a></a></span>
<span id="cb1-20"><a></a><span class="co"># 3. get the probability of sunny</span></span>
<span id="cb1-21"><a></a>p_sunny[i] <span class="ot">&lt;-</span> <span class="fu">sum</span>(W_new, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)<span class="sc">/</span>i</span>
<span id="cb1-22"><a></a></span>
<span id="cb1-23"><a></a>}</span>
<span id="cb1-24"><a></a></span>
<span id="cb1-25"><a></a><span class="fu">plot</span>(p_sunny, <span class="at">type =</span> <span class="st">"l"</span>, <span class="at">xlab =</span> <span class="st">"Iteration"</span>, <span class="at">ylab =</span> <span class="st">"P(S)"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div></div>
</section>
<section id="mcmc-the-metropolis-algorithm" class="slide level2" style="font-size: 70%;">
<h2>MCMC: The Metropolis Algorithm</h2>
<ul>
<li><p>Suppose we have a target distribution <span class="math inline">\(p(\theta|y)\)</span> from which we would like to generate a representative sample.</p></li>
<li><p>Sample values from the target distribution can be generated by taking a random walk through the parameter space.</p></li>
</ul>
<div class="callout callout-caution callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong>The metropolis algorithm</strong></p>
</div>
<div class="callout-content">
<ol start="0" type="1">
<li><p>Start at some arbitrary parameter value (initial value).</p></li>
<li><p>Propose a move to a new value in the parameter space.</p></li>
<li><p>Calculate the acceptance ratio <span class="math inline">\(r = min \bigg(1, \frac{ p(y|\theta_{pro})p(\theta_{pro})}{p(y|\theta_{cur})p(\theta_{cur})}\bigg)\)</span>.</p></li>
<li><p>Draw a random number, <span class="math inline">\(u\)</span> between 0 and 1. If <span class="math inline">\(u &lt; r\)</span> then the move is accepted*.</p></li>
<li><p>Repeat until a representative sample from the target distribution has been generated (more on this later).</p></li>
</ol>
<p>*The random <span class="math inline">\(u\)</span> allows occasional acceptance of worse proposals (with probability <span class="math inline">\(r &lt; 1\)</span>). This introduces randomness that lets the chain explore the entire parameter space.</p>
</div>
</div>
</div>
</section>
<section id="metropolis-algorithm-for-the-happiness-example" class="slide level2" style="font-size: 60%;">
<h2>Metropolis Algorithm for the Happiness example</h2>
<p>Recall for the Happiness example: n = 20 women, y = 14 women reported being happy.</p>
<div class="columns">
<div class="column" style="width:50%;">
<h3 id="the-metropolis-algorithm-1">The Metropolis algorithm</h3>
<p><span class="math inline">\(y \sim Binomial(n = 20, \theta)\)</span></p>
<p><span class="math inline">\(\theta|a,b \sim Beta(a = 1 ,b = 1)\)</span></p>
<ol start="0" type="1">
<li><p>Let‚Äôs initialise using <span class="math inline">\(\theta_{cur}\)</span> = 0.5</p></li>
<li><p>Propose a new move using a Normal proposal distribution such that <span class="math inline">\(\theta_{pro} = \theta_{cur} + N(0,\sigma)\)</span></p></li>
<li><p><span class="math inline">\(r = \text{min} \bigg(1, \frac{ dbinom(y,n,\theta_{pro})dbeta(\theta_{pro},a,b)}{dbinom(y,n,\theta_{cur})dbeta(\theta_{cur},a,b)}\bigg)\)</span></p></li>
<li><p>Compare <span class="math inline">\(u \sim Uniform(0,1)\)</span> with <span class="math inline">\(r\)</span> and accept move if <span class="math inline">\(u &lt; r\)</span></p></li>
<li><p>Repeat</p></li>
</ol>
<p>Visualise the samples and look for a ‚Äúfuzzy caterpiller‚Äù üêõ</p>
</div><div class="column" style="width:50%;">
<h3 id="r-code-1">R code</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb2" data-code-line-numbers="1-2|3-4|5-6|7-10|13-14|15-21|22-25|12,26"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a></a><span class="co"># data </span></span>
<span id="cb2-2"><a></a>y <span class="ot">&lt;-</span> <span class="dv">14</span>; N <span class="ot">&lt;-</span> <span class="dv">20</span></span>
<span id="cb2-3"><a></a><span class="co"># beta prior parameters</span></span>
<span id="cb2-4"><a></a>a <span class="ot">&lt;-</span> <span class="dv">1</span>; b <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb2-5"><a></a><span class="co"># number of samples to generate</span></span>
<span id="cb2-6"><a></a>n_iter <span class="ot">&lt;-</span> <span class="dv">10000</span></span>
<span id="cb2-7"><a></a></span>
<span id="cb2-8"><a></a><span class="co"># 0. </span></span>
<span id="cb2-9"><a></a>theta_cur <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="cn">NA</span>, n_iter)</span>
<span id="cb2-10"><a></a>theta_cur[<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fl">0.5</span></span>
<span id="cb2-11"><a></a></span>
<span id="cb2-12"><a></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>(n_iter<span class="dv">-1</span>)){</span>
<span id="cb2-13"><a></a><span class="co"># 1.</span></span>
<span id="cb2-14"><a></a>theta_pro <span class="ot">&lt;-</span> theta_cur[i] <span class="sc">+</span> <span class="fu">rnorm</span>(<span class="dv">1</span>,<span class="dv">0</span>,<span class="at">sd =</span> <span class="fl">0.2</span>)</span>
<span id="cb2-15"><a></a><span class="co"># 2. </span></span>
<span id="cb2-16"><a></a><span class="cf">if</span>(theta_pro<span class="sc">&lt;</span><span class="dv">0</span><span class="sc">|</span>theta_pro<span class="sc">&gt;</span><span class="dv">1</span>){r <span class="ot">&lt;-</span> <span class="dv">0</span> } <span class="co"># set to zero if theta outside [0,1]</span></span>
<span id="cb2-17"><a></a><span class="cf">else</span> {</span>
<span id="cb2-18"><a></a>  r <span class="ot">&lt;-</span> </span>
<span id="cb2-19"><a></a><span class="fu">min</span>(<span class="dv">1</span>,<span class="fu">dbinom</span>(<span class="dv">14</span>,<span class="dv">20</span>,theta_pro)<span class="sc">*</span><span class="fu">dbeta</span>(theta_pro,a,b)<span class="sc">/</span></span>
<span id="cb2-20"><a></a>      <span class="fu">dbinom</span>(<span class="dv">14</span>,<span class="dv">20</span>,theta_cur[i])<span class="sc">*</span><span class="fu">dbeta</span>(theta_cur[i],a,b))</span>
<span id="cb2-21"><a></a>  }</span>
<span id="cb2-22"><a></a><span class="co"># 3. </span></span>
<span id="cb2-23"><a></a>u <span class="ot">&lt;-</span> <span class="fu">runif</span>(<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">1</span>)</span>
<span id="cb2-24"><a></a>accept <span class="ot">&lt;-</span> u <span class="sc">&lt;</span> r</span>
<span id="cb2-25"><a></a>theta_cur[i<span class="sc">+</span><span class="dv">1</span>]<span class="ot">&lt;-</span> <span class="fu">ifelse</span>(accept,theta_pro,theta_cur[i])</span>
<span id="cb2-26"><a></a>} <span class="co"># end i loop</span></span>
<span id="cb2-27"><a></a></span>
<span id="cb2-28"><a></a><span class="fu">plot</span>(theta_cur, <span class="at">type =</span> <span class="st">"l"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div></div>
</section>
<section id="metropolis-algorithm-for-the-happiness-example-1" class="slide level2" style="font-size: 60%;">
<h2>Metropolis Algorithm for the Happiness example</h2>

<img data-src="4-MCMC_files/figure-revealjs/unnamed-chunk-3-1.gif" class="r-stretch"></section>
<section id="trace-plot-and-chains-for-theta" class="slide level2" style="font-size: 70%;">
<h2>Trace plot and chains for <span class="math inline">\(\theta\)</span></h2>
<ul>
<li><p>Traceplots provide a visual tool for monitoring convergence of an MCMC chain towards a target distribution (i.e., the posterior).</p></li>
<li><p>In general we look for a stationary plot where the sample values display a random scatter around a mean value.</p></li>
<li><p>We typically initialise MCMC algorithms at 3 different start points to see if all chains end up in (converge to) the same place.</p></li>
</ul>

<img data-src="images/mcmc_beta_binom.gif" class="quarto-figure quarto-figure-center r-stretch"></section>
<section id="metropolis-algorithm-for-the-kid-iq-example" class="slide level2" style="font-size: 70%;">
<h2>Metropolis algorithm for the Kid IQ example</h2>
<p>Recall that data (y) are available on the cognitive test scores of three- and four-year-old children in the USA. The sample contains 434 observations.</p>
<p><span class="math inline">\(y_i|\mu,\sigma^2 \sim N(\mu, \sigma^2)\)</span>. Assume <span class="math inline">\(\sigma^2\)</span> is known where <span class="math inline">\(\sigma = 20.4\)</span></p>
<p><span class="math inline">\(\mu|\mu_0,\sigma_0 \sim N(\mu_0 = 80, \sigma^2_{_0} = 10^2)\)</span></p>
<ol start="0" type="1">
<li><p>Let‚Äôs initialise using <span class="math inline">\(\mu_{cur}\)</span> = 80.</p></li>
<li><p>Propose a new move using a Normal proposal distribution such that <span class="math inline">\(\mu_{pro} = \mu_{cur} + N(0,1)\)</span>.</p></li>
<li><p>Calculate the acceptance ratio on the log scale (avoids numerical instability).</p></li>
</ol>
<p><span class="math inline">\(log(r) = \text{min}(0, \sum_i log(dnorm(y_i,\mu_{pro},\sigma)) + log(dnorm(\mu_{pro},\mu_0,\sigma_0))\)</span> <span class="math inline">\(- \sum_i log(dnorm(y_i,\mu_{cur},\sigma)) - log(dnorm(\mu_{cur},\mu_0,\sigma_0)))\)</span></p>
<ol start="3" type="1">
<li>Compare <span class="math inline">\(u \sim Uniform(0,1)\)</span> with <span class="math inline">\(r\)</span> and accept move if <span class="math inline">\(log(u) &lt; r\)</span>.</li>
</ol>
<p><strong>Task:</strong> Code this in R and produce a trace plot for <span class="math inline">\(\mu\)</span>.</p>
</section>
<section id="bayesian-inference-for-mu-and-sigma-the-kid-iq-example" class="slide level2" style="font-size: 70%;">
<h2>Bayesian Inference for <span class="math inline">\(\mu\)</span> <u>and</u> <span class="math inline">\(\sigma\)</span> (the Kid IQ example)</h2>
<ul>
<li><p>It is more realistic to assume <span class="math inline">\(\mu\)</span> and <span class="math inline">\(\sigma\)</span> are unknown.</p></li>
<li><p>In this case we need priors for both parameters and we think about them jointly.</p></li>
<li><p>Then from Bayes‚Äô rule we can get the joint posterior <span class="math inline">\(p(\mu, \sigma |y) \propto p(y|\mu, \sigma)p(\mu,\sigma)\)</span></p></li>
<li><p>Problem: most choices of prior will not result in a closed from expression for the posterior.</p></li>
<li><p>Solution: If we can sample from the target (posterior) distribution we can still do inference.</p></li>
<li><p>The Metropolis method is very useful but can be inefficient. Another sampling method that‚Äôs often used for models with multiple parameters is <strong>Gibbs sampling.</strong></p></li>
</ul>
</section>
<section id="mcmc-the-gibbs-sampler" class="slide level2" style="font-size: 70%;">
<h2>MCMC: The Gibbs Sampler</h2>
<p>We can use Gibbs Sampling when we can sample directly from the <strong>conditional posterior distributions</strong> for each model parameter.</p>
<p>So instead of trying to sample directly from a joint posterior distribution, we sample parameters sequentially from their complete conditional distributions (conditioning on data as well as all other model parameters).</p>
<div class="callout callout-caution callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong>The Gibbs sampling algorithm for <span class="math inline">\(\mu\)</span> and <span class="math inline">\(\tau\)</span></strong></p>
</div>
<div class="callout-content">
<ol start="0" type="1">
<li><p>Assign initial values to the parameters <span class="math inline">\(\mu^{(1)}\)</span> and <span class="math inline">\(\tau^{(1)}\)</span></p></li>
<li><p>Given starting values <span class="math inline">\(\mu^{(1)}\)</span> and <span class="math inline">\(\tau^{(1)}\)</span>, draw samples s = 2, 3,‚Ä¶.,`some large number‚Äô as follows:</p>
<p>1.1. sample <span class="math inline">\(\tau^{(s)}\)</span> from <span class="math inline">\(p(\tau|y,\mu^{(s-1)})\)</span>.</p>
<p>1.2. sample <span class="math inline">\(\mu^{(s)}\)</span> from <span class="math inline">\(p(\mu|y,\tau^{(s)})\)</span></p></li>
<li><p>Repeat and this will (eventually) generate samples from <span class="math inline">\(p(\mu,\sigma|y)\)</span>, which is what we want!</p></li>
</ol>
</div>
</div>
</div>
</section>
<section id="remember-those-complete-conditional-distributions" class="slide level2" style="font-size: 70%;">
<h2>Remember those complete conditional distributions?</h2>
<p>Recall for the Normal likelihood <span class="math inline">\(y_i|\mu,\sigma^2 \sim N(\mu, \sigma^2)\)</span> where <span class="math inline">\(\sigma\)</span> is known and a Normal prior <span class="math inline">\(\mu \sim N(\mu_0, \sigma^2_{_0})\)</span>, we get a posterior for <span class="math inline">\(\mu\)</span> that is also a normal distribution (i.e., we used a conjugate prior)</p>
<p><span class="math display">\[\mu|y \sim N \bigg(\frac{\mu_0/\sigma^2_{0}+ n\bar{y}/\sigma^2}{1/\sigma^2_{0}+n/\sigma^2}, {\frac{1}{1/\sigma^2_{0}+n/\sigma^2}}\bigg)\]</span></p>
<p>Recall for the Normal likelihood <span class="math inline">\(y_i|\mu,\sigma^2 \sim N(\mu, \sigma^2)\)</span> where <span class="math inline">\(\mu\)</span> is known and a Gamma prior <span class="math inline">\(\frac{1}{\sigma^2} = \tau \sim Gamma(a, b)\)</span> we get a posterior for <span class="math inline">\(\tau\)</span> that will also be a gamma distribution</p>
<p><span class="math display">\[\tau|y \sim Gamma \bigg(a + n/2, b + 1/2\sum_{i=1}^n (y_i - \mu)^2\bigg)\]</span></p>
<p>These are the <strong>complete conditionals</strong>. We know the posterior distribution for one parameter conditional on knowning the other parameter(s). Now we can use Gibbs sampling.</p>
</section>
<section id="gibbs-sampling-algorithm-for-the-kid-iq-example" class="slide level2" style="font-size: 70%;">
<h2>Gibbs sampling algorithm for the Kid IQ example</h2>
<p>Recall data (y) are available on the cognitive test scores of three- and four-year-old children in the USA. The sample contains <span class="math inline">\(n=434\)</span> observations.</p>
<div class="columns">
<div class="column" style="width:50%;">
<p><span class="math inline">\(y \sim Normal(\mu, \sigma^2)\)</span></p>
<p><span class="math inline">\(\mu \sim Normal(80 ,10)\)</span> <span class="math inline">\(1/\sigma^2 = \tau \sim gamma(1 ,1)\)</span></p>
<ol start="0" type="1">
<li><p>Let‚Äôs initialise using <span class="math inline">\(\mu^{(1)} = 80, \tau^{(1)} = 1\)</span></p></li>
<li><p>Given starting values <span class="math inline">\(\mu^{(1)}\)</span> and <span class="math inline">\(\tau^{(1)}\)</span>, draw samples s = 2, 3,‚Ä¶.,`some large number‚Äô as follows:</p>
<p>1.1. sample <span class="math inline">\(\tau^{(s)}\)</span> from <span class="math inline">\(p(\tau|y,\mu^{(s-1)})\)</span>.</p>
<p>1.2. sample <span class="math inline">\(\mu^{(s)}\)</span> from <span class="math inline">\(p(\mu|y,\tau^{(s)})\)</span></p></li>
<li><p>Repeat and this will (eventually) generate samples from <span class="math inline">\(p(\mu,\sigma|y)\)</span>, which is what we want!</p></li>
</ol>
</div><div class="column" style="width:50%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb3" data-code-line-numbers="1-11|13-16|20-30|19,31"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a></a><span class="do">## Data</span></span>
<span id="cb3-2"><a></a>y <span class="ot">&lt;-</span> kidiq<span class="sc">$</span>kid_score</span>
<span id="cb3-3"><a></a>n <span class="ot">&lt;-</span> <span class="fu">length</span>(y)</span>
<span id="cb3-4"><a></a></span>
<span id="cb3-5"><a></a><span class="do">## Prior parameters </span></span>
<span id="cb3-6"><a></a>mu0 <span class="ot">&lt;-</span> <span class="dv">80</span>; sigma.mu0 <span class="ot">&lt;-</span> <span class="dv">10</span> <span class="co"># for normal prior (for mu)</span></span>
<span id="cb3-7"><a></a>a <span class="ot">&lt;-</span> <span class="dv">1</span>; b <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="co"># for gamma prior (for tau)</span></span>
<span id="cb3-8"><a></a></span>
<span id="cb3-9"><a></a>n_iter <span class="ot">&lt;-</span> <span class="dv">10000</span> <span class="do">## choose # iter</span></span>
<span id="cb3-10"><a></a><span class="do">## create objects to store results</span></span>
<span id="cb3-11"><a></a>mu_s <span class="ot">&lt;-</span> tau_s <span class="ot">&lt;-</span> sigma_s <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="cn">NA</span>, n_iter)</span>
<span id="cb3-12"><a></a></span>
<span id="cb3-13"><a></a><span class="do">## 0. Initialise </span></span>
<span id="cb3-14"><a></a>mu_s[<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="dv">80</span>; tau_s[<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="dv">1</span>; sigma_s[<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb3-15"><a></a><span class="do">## define parameters for gamma posterior on tau</span></span>
<span id="cb3-16"><a></a>post.a <span class="ot">=</span> a <span class="sc">+</span> n<span class="sc">/</span><span class="dv">2</span>; post.b <span class="ot">=</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">2</span><span class="sc">*</span>(<span class="fu">sum</span>((y<span class="sc">-</span>mu_s[<span class="dv">1</span>])<span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb3-17"><a></a></span>
<span id="cb3-18"><a></a><span class="do">## 1.</span></span>
<span id="cb3-19"><a></a><span class="cf">for</span>(s <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span>n_iter){</span>
<span id="cb3-20"><a></a><span class="do">## 1.1 sample from complete conditional for tau</span></span>
<span id="cb3-21"><a></a>tau_s[s] <span class="ot">&lt;-</span> <span class="fu">rgamma</span>(<span class="dv">1</span>,post.a,post.b)</span>
<span id="cb3-22"><a></a>sigma_s[s] <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="dv">1</span><span class="sc">/</span>tau_s[s]) <span class="co"># transform to sigma</span></span>
<span id="cb3-23"><a></a><span class="do">## update posterior parameters for mu</span></span>
<span id="cb3-24"><a></a>mupost.mean <span class="ot">=</span> (mu0<span class="sc">/</span>(sigma.mu0<span class="sc">^</span><span class="dv">2</span>) <span class="sc">+</span> tau_s[s]<span class="sc">*</span>n<span class="sc">*</span><span class="fu">mean</span>(y))<span class="sc">/</span>(<span class="dv">1</span><span class="sc">/</span>(sigma.mu0<span class="sc">^</span><span class="dv">2</span>) <span class="sc">+</span> tau_s[s]<span class="sc">*</span>n)</span>
<span id="cb3-25"><a></a>mupost.sd <span class="ot">=</span> <span class="fu">sqrt</span>(<span class="dv">1</span><span class="sc">/</span>(<span class="dv">1</span><span class="sc">/</span>(sigma.mu0<span class="sc">^</span><span class="dv">2</span>)<span class="sc">+</span>tau_s[s]<span class="sc">*</span>n))</span>
<span id="cb3-26"><a></a><span class="do">## 1.2 sample from complete conditional for mu</span></span>
<span id="cb3-27"><a></a>mu_s[s] <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">1</span>,mupost.mean,mupost.sd)</span>
<span id="cb3-28"><a></a><span class="do">## update posterior parameters for tau</span></span>
<span id="cb3-29"><a></a>post.a <span class="ot">=</span> a <span class="sc">+</span> n<span class="sc">/</span><span class="dv">2</span></span>
<span id="cb3-30"><a></a>post.b <span class="ot">=</span> b <span class="sc">+</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">2</span><span class="sc">*</span>(<span class="fu">sum</span>((y<span class="sc">-</span>mu_s[s])<span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb3-31"><a></a>} <span class="co"># end s loop</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div></div>
</section>
<section id="output-from-mcmc" class="slide level2" style="font-size: 60%;">
<h2>Output from MCMC</h2>
<p>MCMC samples are not <em>independent</em> draws from a target distribution:</p>
<ul>
<li><p>The first draw is not a random draw from the target distribution and tuning of MCMC parameters may occur at the start of a chain.</p></li>
<li><p>Subsequently, draw s + 1 depends on draw s: the samples may be autocorrelated.</p></li>
</ul>
<p>We can use samples from an MCMC algorithm to do inference but ONLY IF</p>
<ul>
<li><p>We exclude samples from the initial period (burn-in).</p></li>
<li><p>We ‚Äúwait long enough‚Äù to get a set of samples that are representative of the target (posterior). distribution.</p></li>
</ul>
<div class="cell columns column-output-location">
<div class="column">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a></a><span class="co"># Create a dataset (tibble) of samples</span></span>
<span id="cb4-2"><a></a><span class="co"># chose a "burn-in" </span></span>
<span id="cb4-3"><a></a>n_burnin <span class="ot">&lt;-</span> <span class="dv">100</span></span>
<span id="cb4-4"><a></a><span class="co"># Remove the first sample from mu_s and sigma_s</span></span>
<span id="cb4-5"><a></a>post_samps <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">sample_index =</span> <span class="dv">1</span><span class="sc">:</span>(n_iter<span class="sc">-</span>n_burnin),</span>
<span id="cb4-6"><a></a>                     <span class="at">mu_s =</span> mu_s[<span class="sc">-</span>(<span class="dv">1</span><span class="sc">:</span>n_burnin)], </span>
<span id="cb4-7"><a></a>                     <span class="at">sigma_s =</span> sigma_s[<span class="sc">-</span>(<span class="dv">1</span><span class="sc">:</span>n_burnin)])</span>
<span id="cb4-8"><a></a>post_samps</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div><div class="column fragment">
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 9,900 √ó 3
   sample_index  mu_s sigma_s
          &lt;int&gt; &lt;dbl&gt;   &lt;dbl&gt;
 1            1  85.7    21.7
 2            2  86.2    20.8
 3            3  87.8    20.2
 4            4  87.9    21.5
 5            5  86.6    21.1
 6            6  87.0    19.9
 7            7  87.7    19.6
 8            8  86.1    21.0
 9            9  87.7    19.9
10           10  86.8    20.6
# ‚Ñπ 9,890 more rows</code></pre>
</div>
</div></div>
</section>
<section id="output-from-mcmc-trace-plots" class="slide level2" style="font-size: 60%;">
<h2>Output from MCMC: trace plots</h2>
<p>We can use trace plots to investigate the MCMC samples/chains for the parameters.</p>
<div class="cell columns column-output-location">
<div class="column">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb6-2"><a></a></span>
<span id="cb6-3"><a></a><span class="co"># Trace plot for mu</span></span>
<span id="cb6-4"><a></a>p1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(post_samps, <span class="fu">aes</span>(<span class="at">x =</span> sample_index, mu_s)) <span class="sc">+</span></span>
<span id="cb6-5"><a></a>        <span class="fu">geom_line</span>(<span class="at">colour =</span> <span class="st">"blue"</span>) <span class="sc">+</span></span>
<span id="cb6-6"><a></a>        <span class="fu">ggtitle</span>(<span class="st">"Posterior Samples of mu"</span>)</span>
<span id="cb6-7"><a></a></span>
<span id="cb6-8"><a></a><span class="co"># Trace plot for sigma</span></span>
<span id="cb6-9"><a></a>p2 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(post_samps, <span class="fu">aes</span>(<span class="at">x =</span> sample_index, sigma_s)) <span class="sc">+</span></span>
<span id="cb6-10"><a></a>        <span class="fu">geom_line</span>(<span class="at">colour =</span> <span class="st">"blue"</span>) <span class="sc">+</span></span>
<span id="cb6-11"><a></a>        <span class="fu">ggtitle</span>(<span class="st">"Posterior Samples of sigma"</span>)</span>
<span id="cb6-12"><a></a></span>
<span id="cb6-13"><a></a>p1;p2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div><div class="column fragment">
<div class="cell-output-display">
<div>
<figure>
<p><img data-src="4-MCMC_files/figure-revealjs/unnamed-chunk-7-1.png" width="960"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure>
<p><img data-src="4-MCMC_files/figure-revealjs/unnamed-chunk-7-2.png" width="960"></p>
</figure>
</div>
</div>
</div></div>
</section>
<section id="output-from-mcmc-joint-parameter-plots" class="slide level2" style="font-size: 60%;">
<h2>Output from MCMC: joint parameter plots</h2>
<p>We can visualise the joint posterior distribution of the parameters based on the MCMC samples.</p>
<div class="cell columns column-output-location">
<div class="column">
<div class="sourceCode cell-code" id="cb7" data-code-line-numbers="1-9"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a></a><span class="co"># Scatter plot of mu_s vs. sd_s</span></span>
<span id="cb7-2"><a></a>p3 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(post_samps, <span class="fu">aes</span>(<span class="at">x =</span> sigma_s, mu_s)) <span class="sc">+</span></span>
<span id="cb7-3"><a></a>        <span class="fu">geom_point</span>(<span class="at">colour =</span> <span class="st">"blue"</span>) </span>
<span id="cb7-4"><a></a></span>
<span id="cb7-5"><a></a><span class="co"># Contour plot of joint density</span></span>
<span id="cb7-6"><a></a>p4 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(post_samps, <span class="fu">aes</span>(<span class="at">x =</span> sigma_s, <span class="at">y =</span> mu_s)) <span class="sc">+</span> </span>
<span id="cb7-7"><a></a>  <span class="fu">geom_density_2d</span>(<span class="at">colour =</span> <span class="st">"blue"</span>)    </span>
<span id="cb7-8"><a></a></span>
<span id="cb7-9"><a></a>p3;p4</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div><div class="column fragment">
<div class="cell-output-display">
<div>
<figure>
<p><img data-src="4-MCMC_files/figure-revealjs/unnamed-chunk-8-1.png" width="960"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure>
<p><img data-src="4-MCMC_files/figure-revealjs/unnamed-chunk-8-2.png" width="960"></p>
</figure>
</div>
</div>
</div></div>
</section>
<section id="output-from-mcmc-density-plots-and-summaries" class="slide level2" style="font-size: 60%;">
<h2>Output from MCMC: density plots and summaries</h2>
<p>We can visualise and obtain summaries for the marginal posterior distributions of the parameters based on the MCMC samples.</p>
<div class="cell columns column-output-location">
<div class="column">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a></a><span class="co"># Density plot for posterior samples of mu</span></span>
<span id="cb8-2"><a></a>p5 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(post_samps, <span class="fu">aes</span>(<span class="at">x =</span> mu_s)) <span class="sc">+</span></span>
<span id="cb8-3"><a></a>        <span class="fu">geom_density</span>(<span class="at">fill =</span> <span class="st">"lightblue"</span>, </span>
<span id="cb8-4"><a></a>                     <span class="at">color =</span> <span class="st">"blue"</span>, </span>
<span id="cb8-5"><a></a>                     <span class="at">alpha =</span> <span class="fl">0.6</span>) <span class="sc">+</span></span>
<span id="cb8-6"><a></a>        <span class="fu">ggtitle</span>(<span class="st">"Posterior Density of mu"</span>) </span>
<span id="cb8-7"><a></a></span>
<span id="cb8-8"><a></a><span class="co"># Mean and credible interval for mu</span></span>
<span id="cb8-9"><a></a>mu_mean <span class="ot">&lt;-</span> <span class="fu">mean</span>(mu_s)</span>
<span id="cb8-10"><a></a>mu_ci <span class="ot">&lt;-</span> <span class="fu">quantile</span>(mu_s, <span class="at">probs =</span> <span class="fu">c</span>(<span class="fl">0.025</span>, <span class="fl">0.975</span>))</span>
<span id="cb8-11"><a></a></span>
<span id="cb8-12"><a></a>p5;<span class="fu">cat</span>(<span class="st">"Mean of Mu:"</span>, mu_mean, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>);<span class="fu">cat</span>(<span class="st">"95% Credible Interval for Mu:"</span>, mu_ci, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div><div class="column fragment">
<div class="cell-output-display">
<div>
<figure>
<p><img data-src="4-MCMC_files/figure-revealjs/unnamed-chunk-9-1.png" width="960"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Mean of Mu: 86.72347 </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>95% Credible Interval for Mu: 84.80829 88.58212 </code></pre>
</div>
</div></div>
<div class="cell columns column-output-location">
<div class="column">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a></a>p6 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(post_samps, <span class="fu">aes</span>(<span class="at">x =</span> sigma_s)) <span class="sc">+</span></span>
<span id="cb11-2"><a></a>        <span class="fu">geom_density</span>(<span class="at">fill =</span> <span class="st">"lightblue"</span>, </span>
<span id="cb11-3"><a></a>                     <span class="at">color =</span> <span class="st">"blue"</span>, </span>
<span id="cb11-4"><a></a>                     <span class="at">alpha =</span> <span class="fl">0.6</span>) <span class="sc">+</span></span>
<span id="cb11-5"><a></a>        <span class="fu">ggtitle</span>(<span class="st">"Posterior Density of sigma"</span>) </span>
<span id="cb11-6"><a></a></span>
<span id="cb11-7"><a></a><span class="co"># Mean and credible interval for sigma</span></span>
<span id="cb11-8"><a></a>sigma_mean <span class="ot">&lt;-</span> <span class="fu">mean</span>(sigma_s)</span>
<span id="cb11-9"><a></a>sigma_ci <span class="ot">&lt;-</span> <span class="fu">quantile</span>(sigma_s, <span class="at">probs =</span> <span class="fu">c</span>(<span class="fl">0.025</span>, <span class="fl">0.975</span>))</span>
<span id="cb11-10"><a></a></span>
<span id="cb11-11"><a></a>p6;<span class="fu">cat</span>(<span class="st">"Mean of Sigma:"</span>, sigma_mean, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>);<span class="fu">cat</span>(<span class="st">"95% Credible Interval for Sigma:"</span>, sigma_ci, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div><div class="column fragment">
<div class="cell-output-display">
<div>
<figure>
<p><img data-src="4-MCMC_files/figure-revealjs/unnamed-chunk-10-1.png" width="960"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Mean of Sigma: 20.40462 </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>95% Credible Interval for Sigma: 19.0815 21.81461 </code></pre>
</div>
</div></div>

<div class="quarto-auto-generated-content">
<div class="footer footer-default">

</div>
</div>
</section>
    </div>
  </div>

  <script>window.backupDefine = window.define; window.define = undefined;</script>
  <script src="site_libs/revealjs/dist/reveal.js"></script>
  <!-- reveal.js plugins -->
  <script src="site_libs/revealjs/plugin/quarto-line-highlight/line-highlight.js"></script>
  <script src="site_libs/revealjs/plugin/pdf-export/pdfexport.js"></script>
  <script src="site_libs/revealjs/plugin/reveal-menu/menu.js"></script>
  <script src="site_libs/revealjs/plugin/reveal-menu/quarto-menu.js"></script>
  <script src="site_libs/revealjs/plugin/quarto-support/support.js"></script>
  

  <script src="site_libs/revealjs/plugin/notes/notes.js"></script>
  <script src="site_libs/revealjs/plugin/search/search.js"></script>
  <script src="site_libs/revealjs/plugin/zoom/zoom.js"></script>
  <script src="site_libs/revealjs/plugin/math/math.js"></script>
  <script>window.define = window.backupDefine; window.backupDefine = undefined;</script>

  <script>

      // Full list of configuration options available at:
      // https://revealjs.com/config/
      Reveal.initialize({
'controlsAuto': true,
'previewLinksAuto': false,
'pdfSeparateFragments': false,
'autoAnimateEasing': "ease",
'autoAnimateDuration': 1,
'autoAnimateUnmatched': true,
'menu': {"side":"left","useTextContentForMissingTitles":true,"markers":false,"loadIcons":false,"custom":[{"title":"Tools","icon":"<i class=\"fas fa-gear\"></i>","content":"<ul class=\"slide-menu-items\">\n<li class=\"slide-tool-item active\" data-item=\"0\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.fullscreen(event)\"><kbd>f</kbd> Fullscreen</a></li>\n<li class=\"slide-tool-item\" data-item=\"1\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.speakerMode(event)\"><kbd>s</kbd> Speaker View</a></li>\n<li class=\"slide-tool-item\" data-item=\"2\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.overview(event)\"><kbd>o</kbd> Slide Overview</a></li>\n<li class=\"slide-tool-item\" data-item=\"3\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.togglePdfExport(event)\"><kbd>e</kbd> PDF Export Mode</a></li>\n<li class=\"slide-tool-item\" data-item=\"4\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.keyboardHelp(event)\"><kbd>?</kbd> Keyboard Help</a></li>\n</ul>"}],"openButton":true},
'smaller': false,
 
        // Display controls in the bottom right corner
        controls: false,

        // Help the user learn the controls by providing hints, for example by
        // bouncing the down arrow when they first encounter a vertical slide
        controlsTutorial: false,

        // Determines where controls appear, "edges" or "bottom-right"
        controlsLayout: 'edges',

        // Visibility rule for backwards navigation arrows; "faded", "hidden"
        // or "visible"
        controlsBackArrows: 'faded',

        // Display a presentation progress bar
        progress: true,

        // Display the page number of the current slide
        slideNumber: false,

        // 'all', 'print', or 'speaker'
        showSlideNumber: 'all',

        // Add the current slide number to the URL hash so that reloading the
        // page/copying the URL will return you to the same slide
        hash: true,

        // Start with 1 for the hash rather than 0
        hashOneBasedIndex: false,

        // Flags if we should monitor the hash and change slides accordingly
        respondToHashChanges: true,

        // Push each slide change to the browser history
        history: true,

        // Enable keyboard shortcuts for navigation
        keyboard: true,

        // Enable the slide overview mode
        overview: true,

        // Disables the default reveal.js slide layout (scaling and centering)
        // so that you can use custom CSS layout
        disableLayout: false,

        // Vertical centering of slides
        center: false,

        // Enables touch navigation on devices with touch input
        touch: true,

        // Loop the presentation
        loop: false,

        // Change the presentation direction to be RTL
        rtl: false,

        // see https://revealjs.com/vertical-slides/#navigation-mode
        navigationMode: 'linear',

        // Randomizes the order of slides each time the presentation loads
        shuffle: false,

        // Turns fragments on and off globally
        fragments: true,

        // Flags whether to include the current fragment in the URL,
        // so that reloading brings you to the same fragment position
        fragmentInURL: false,

        // Flags if the presentation is running in an embedded mode,
        // i.e. contained within a limited portion of the screen
        embedded: false,

        // Flags if we should show a help overlay when the questionmark
        // key is pressed
        help: true,

        // Flags if it should be possible to pause the presentation (blackout)
        pause: true,

        // Flags if speaker notes should be visible to all viewers
        showNotes: false,

        // Global override for autoplaying embedded media (null/true/false)
        autoPlayMedia: null,

        // Global override for preloading lazy-loaded iframes (null/true/false)
        preloadIframes: null,

        // Number of milliseconds between automatically proceeding to the
        // next slide, disabled when set to 0, this value can be overwritten
        // by using a data-autoslide attribute on your slides
        autoSlide: 0,

        // Stop auto-sliding after user input
        autoSlideStoppable: true,

        // Use this method for navigation when auto-sliding
        autoSlideMethod: null,

        // Specify the average time in seconds that you think you will spend
        // presenting each slide. This is used to show a pacing timer in the
        // speaker view
        defaultTiming: null,

        // Enable slide navigation via mouse wheel
        mouseWheel: false,

        // The display mode that will be used to show slides
        display: 'block',

        // Hide cursor if inactive
        hideInactiveCursor: true,

        // Time before the cursor is hidden (in ms)
        hideCursorTime: 5000,

        // Opens links in an iframe preview overlay
        previewLinks: false,

        // Transition style (none/fade/slide/convex/concave/zoom)
        transition: 'none',

        // Transition speed (default/fast/slow)
        transitionSpeed: 'default',

        // Transition style for full page slide backgrounds
        // (none/fade/slide/convex/concave/zoom)
        backgroundTransition: 'none',

        // Number of slides away from the current that are visible
        viewDistance: 3,

        // Number of slides away from the current that are visible on mobile
        // devices. It is advisable to set this to a lower number than
        // viewDistance in order to save resources.
        mobileViewDistance: 2,

        // The "normal" size of the presentation, aspect ratio will be preserved
        // when the presentation is scaled to fit different resolutions. Can be
        // specified using percentage units.
        width: 1050,

        height: 700,

        // Factor of the display size that should remain empty around the content
        margin: 0.1,

        math: {
          mathjax: 'https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js',
          config: 'TeX-AMS_HTML-full',
          tex2jax: {
            inlineMath: [['\\(','\\)']],
            displayMath: [['\\[','\\]']],
            balanceBraces: true,
            processEscapes: false,
            processRefs: true,
            processEnvironments: true,
            preview: 'TeX',
            skipTags: ['script','noscript','style','textarea','pre','code'],
            ignoreClass: 'tex2jax_ignore',
            processClass: 'tex2jax_process'
          },
        },

        // reveal.js plugins
        plugins: [QuartoLineHighlight, PdfExport, RevealMenu, QuartoSupport,

          RevealMath,
          RevealNotes,
          RevealSearch,
          RevealZoom
        ]
      });
    </script>
    
    <script>
      // htmlwidgets need to know to resize themselves when slides are shown/hidden.
      // Fire the "slideenter" event (handled by htmlwidgets.js) when the current
      // slide changes (different for each slide format).
      (function () {
        // dispatch for htmlwidgets
        function fireSlideEnter() {
          const event = window.document.createEvent("Event");
          event.initEvent("slideenter", true, true);
          window.document.dispatchEvent(event);
        }

        function fireSlideChanged(previousSlide, currentSlide) {
          fireSlideEnter();

          // dispatch for shiny
          if (window.jQuery) {
            if (previousSlide) {
              window.jQuery(previousSlide).trigger("hidden");
            }
            if (currentSlide) {
              window.jQuery(currentSlide).trigger("shown");
            }
          }
        }

        // hookup for slidy
        if (window.w3c_slidy) {
          window.w3c_slidy.add_observer(function (slide_num) {
            // slide_num starts at position 1
            fireSlideChanged(null, w3c_slidy.slides[slide_num - 1]);
          });
        }

      })();
    </script>

    <script id="quarto-html-after-body" type="application/javascript">
    window.document.addEventListener("DOMContentLoaded", function (event) {
      const toggleBodyColorMode = (bsSheetEl) => {
        const mode = bsSheetEl.getAttribute("data-mode");
        const bodyEl = window.document.querySelector("body");
        if (mode === "dark") {
          bodyEl.classList.add("quarto-dark");
          bodyEl.classList.remove("quarto-light");
        } else {
          bodyEl.classList.add("quarto-light");
          bodyEl.classList.remove("quarto-dark");
        }
      }
      const toggleBodyColorPrimary = () => {
        const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
        if (bsSheetEl) {
          toggleBodyColorMode(bsSheetEl);
        }
      }
      toggleBodyColorPrimary();  
      const tabsets =  window.document.querySelectorAll(".panel-tabset-tabby")
      tabsets.forEach(function(tabset) {
        const tabby = new Tabby('#' + tabset.id);
      });
      const isCodeAnnotation = (el) => {
        for (const clz of el.classList) {
          if (clz.startsWith('code-annotation-')) {                     
            return true;
          }
        }
        return false;
      }
      const onCopySuccess = function(e) {
        // button target
        const button = e.trigger;
        // don't keep focus
        button.blur();
        // flash "checked"
        button.classList.add('code-copy-button-checked');
        var currentTitle = button.getAttribute("title");
        button.setAttribute("title", "Copied!");
        let tooltip;
        if (window.bootstrap) {
          button.setAttribute("data-bs-toggle", "tooltip");
          button.setAttribute("data-bs-placement", "left");
          button.setAttribute("data-bs-title", "Copied!");
          tooltip = new bootstrap.Tooltip(button, 
            { trigger: "manual", 
              customClass: "code-copy-button-tooltip",
              offset: [0, -8]});
          tooltip.show();    
        }
        setTimeout(function() {
          if (tooltip) {
            tooltip.hide();
            button.removeAttribute("data-bs-title");
            button.removeAttribute("data-bs-toggle");
            button.removeAttribute("data-bs-placement");
          }
          button.setAttribute("title", currentTitle);
          button.classList.remove('code-copy-button-checked');
        }, 1000);
        // clear code selection
        e.clearSelection();
      }
      const getTextToCopy = function(trigger) {
          const codeEl = trigger.previousElementSibling.cloneNode(true);
          for (const childEl of codeEl.children) {
            if (isCodeAnnotation(childEl)) {
              childEl.remove();
            }
          }
          return codeEl.innerText;
      }
      const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
        text: getTextToCopy
      });
      clipboard.on('success', onCopySuccess);
      if (window.document.getElementById('quarto-embedded-source-code-modal')) {
        // For code content inside modals, clipBoardJS needs to be initialized with a container option
        // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
        const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
          text: getTextToCopy,
          container: window.document.getElementById('quarto-embedded-source-code-modal')
        });
        clipboardModal.on('success', onCopySuccess);
      }
        var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
        var mailtoRegex = new RegExp(/^mailto:/);
          var filterRegex = new RegExp('/' + window.location.host + '/');
        var isInternal = (href) => {
            return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
        }
        // Inspect non-navigation links and adorn them if external
     	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
        for (var i=0; i<links.length; i++) {
          const link = links[i];
          if (!isInternal(link.href)) {
            // undo the damage that might have been done by quarto-nav.js in the case of
            // links that we want to consider external
            if (link.dataset.originalHref !== undefined) {
              link.href = link.dataset.originalHref;
            }
          }
        }
      function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
        const config = {
          allowHTML: true,
          maxWidth: 500,
          delay: 100,
          arrow: false,
          appendTo: function(el) {
              return el.closest('section.slide') || el.parentElement;
          },
          interactive: true,
          interactiveBorder: 10,
          theme: 'light-border',
          placement: 'bottom-start',
        };
        if (contentFn) {
          config.content = contentFn;
        }
        if (onTriggerFn) {
          config.onTrigger = onTriggerFn;
        }
        if (onUntriggerFn) {
          config.onUntrigger = onUntriggerFn;
        }
          config['offset'] = [0,0];
          config['maxWidth'] = 700;
        window.tippy(el, config); 
      }
      const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
      for (var i=0; i<noterefs.length; i++) {
        const ref = noterefs[i];
        tippyHover(ref, function() {
          // use id or data attribute instead here
          let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
          try { href = new URL(href).hash; } catch {}
          const id = href.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note) {
            return note.innerHTML;
          } else {
            return "";
          }
        });
      }
      const findCites = (el) => {
        const parentEl = el.parentElement;
        if (parentEl) {
          const cites = parentEl.dataset.cites;
          if (cites) {
            return {
              el,
              cites: cites.split(' ')
            };
          } else {
            return findCites(el.parentElement)
          }
        } else {
          return undefined;
        }
      };
      var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
      for (var i=0; i<bibliorefs.length; i++) {
        const ref = bibliorefs[i];
        const citeInfo = findCites(ref);
        if (citeInfo) {
          tippyHover(citeInfo.el, function() {
            var popup = window.document.createElement('div');
            citeInfo.cites.forEach(function(cite) {
              var citeDiv = window.document.createElement('div');
              citeDiv.classList.add('hanging-indent');
              citeDiv.classList.add('csl-entry');
              var biblioDiv = window.document.getElementById('ref-' + cite);
              if (biblioDiv) {
                citeDiv.innerHTML = biblioDiv.innerHTML;
              }
              popup.appendChild(citeDiv);
            });
            return popup.innerHTML;
          });
        }
      }
    });
    </script>
    

</body></html>